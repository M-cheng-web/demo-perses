# 错误处理规范

## 错误分层

- `契约错误`：调用方输入不合法（例如 SDK action 参数非法）。
- `业务错误`：接口返回失败、校验不通过、资源不存在。
- `系统错误`：未预期异常（渲染崩溃、运行时 bug）。

## 处理原则

- `throw`：用于契约错误和需要上层显式处理的失败（不可静默吞掉）。
- `message.error/warning`：用于用户可感知且可操作的问题（保存失败、导入失败）。
- `logger/console`：用于开发排障信息，不替代用户提示。
- `冷却机制`：高频重复错误必须节流，避免 toast 风暴。

## 责任边界

- `store`：保存结构化错误状态（如 `lastError`），不做复杂 UI 决策。
- `hook`：做错误聚合、节流和跨组件复用策略（例如 dashboard 状态提示）。
- `component`：只负责展示，不重复拼接错误语义。

## 实施细则

- 用户可恢复的错误必须给出下一步建议（重试、检查配置、导入 JSON）。
- 自动流程失败（如 auto-sync）需要明确说明是否已回滚。
- 所有公共 SDK action 在边界处做输入校验，错误信息应稳定可检索。
